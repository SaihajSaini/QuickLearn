import { ComponentType } from 'react';
import { ExperimentsConfig, NotificationCount } from '../types';

export type SpotlightContext = {
    open: (path: string | undefined) => void;
    close: () => void;
    experiments: ExperimentsConfig;
    sidecarUrl: string;
};
export type Integration<T = any> = {
    /**
     * Name of the integration
     */
    name: string;
    /**
     * The content-type http headers determining which events dispatched to spotlight
     * events should be forwarded to this integration.
     *
     * For example: ["application/x-sentry-envelope"]
     */
    forwardedContentType?: string[];
    /**
     * A function returning an array of links to be displayed in the UI.
     *
     * @param context contains the processed events for the links. Use this information to
     * e.g. update the notification count badge of the link.
     */
    panels?: PanelsCreationFunction<T>;
    /**
     * @deprecated Use `links` instead.
     */
    tabs?: PanelsCreationFunction<T>;
    /**
     * Setup hook called when Spotlight is initialized.
     *
     * Use this hook to setup any global state, instrument handlers, etc.
     */
    setup?: (context: SpotlightContext) => void | Promise<void> | TeardownFunction;
    /**
     * Hook called whenever spotlight forwards a new raw event to this integration.
     *
     * Use this hook to process and convert the raw request payload (string) to a
     * data structure that your integration works with in the UI.
     *
     * If you want to disregard the sent event, simply return `undefined`.
     *
     * The returned object will be passed to your tabs function.
     */
    processEvent?: (eventContext: RawEventContext) => ProcessedEventContainer<T> | undefined;
    /**
     * To reset the integration.
     *
     * @returns void
     */
    reset?: () => void;
};
export type IntegrationPanel<T> = {
    /**
     * Id of the tab. This needs to be a unique name.
     */
    id: string;
    /**
     * Title of the tab. This is what will be displayed in the UI.
     */
    title: string;
    /**
     * If this property is set, a count badge will be displayed
     * next to the tab title with the specified value.
     */
    notificationCount?: NotificationCount;
    /**
     * JSX content of the tab. Go crazy, this is all yours!
     */
    content?: ComponentType<{
        processedEvents: T[];
    }>;
    onSelect?: () => void;
    /**
     * A function returning an array of panels to be displayed in the UI as children of the
     * parent panel.
     *
     * @param context contains the processed events for the panels. Use this information to
     * e.g. update the notification count badge of the panel.
     */
    panels?: (context: PanelContext<T>) => IntegrationPanel<T>[];
};
type PanelContext<T> = {
    processedEvents: T[];
};
type PanelsCreationFunction<T> = (context: PanelContext<T>) => IntegrationPanel<T>[];
export type ProcessedEventContainer<T> = {
    /**
     * The processed event data to be passed to your links.
     */
    event: T;
};
export type IntegrationData<T> = Record<string, ProcessedEventContainer<T>[]>;
export type Severity = "default" | "severe";
export type RawEventContext = {
    /**
     * The content-type header of the event
     */
    contentType: string;
    /**
     * The raw data in string form of the request.
     * Use this function to parse and process the raw data it to whatever data structure
     * you expect for the given `contentType`.
     *
     * Return the processed object or undefined if the event should be ignored.
     */
    data: string | Uint8Array;
};
type TeardownFunction = () => void | Promise<() => void>;
export declare function initIntegrations(integrations: Integration[], context: SpotlightContext): Promise<[Integration[], TeardownFunction[]]>;
export {};
